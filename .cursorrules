# Bologna Marathon - Sistema Modulare
# File di contesto per Cursor AI

## ğŸƒâ€â™‚ï¸ PROGETTO
Sistema modulare per il sito ufficiale della Bologna Marathon (bolognamarathon.run)
- **Tipo**: Sito sportivo modulare
- **Tecnologie**: PHP 8+, MySQL, CSS Variables, JavaScript vanilla
- **Architettura**: SSR (Server-Side Rendering) modulare
- **Path**: `http://localhost/sito_modulare/`

## ğŸ“ STRUTTURA PROGETTO
```
sito_modulare/
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ css/core/          # CSS core (variables, reset, typography)
â”‚   â”œâ”€â”€ css/main.css       # Stili principali
â”‚   â”œâ”€â”€ js/core/           # JavaScript core
â”‚   â””â”€â”€ images/            # Immagini
â”œâ”€â”€ config/
â”‚   â””â”€â”€ database.php       # Configurazione database
â”œâ”€â”€ core/
â”‚   â””â”€â”€ ModuleRenderer.php # Sistema rendering moduli SSR
â”œâ”€â”€ modules/               # Moduli riutilizzabili
â”‚   â”œâ”€â”€ hero/             # Action Hero
â”‚   â”œâ”€â”€ results/          # Tabella risultati
â”‚   â”œâ”€â”€ menu/             # Menu navigazione
â”‚   â”œâ”€â”€ footer/           # Footer sito
â”‚   â””â”€â”€ text/             # Rich Text
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ schema.sql        # Schema database
â”‚   â””â”€â”€ test_data.sql     # Dati di test
â”œâ”€â”€ admin/
â”‚   â”œâ”€â”€ test-setup.php    # Setup database
â”‚   â””â”€â”€ admin.php         # Pannello admin
â””â”€â”€ index.php            # Homepage principale
```

## ğŸ¨ SISTEMA CSS VARIABLES
**File principale**: `assets/css/core/variables.css`

### Colori Principali
- `--primary`: #23a8eb (Colore principale)
- `--secondary`: #dc335e (Colore secondario)
- `--accent`: #cbdf44 (Colore accent)
- `--info`: #5DADE2 (Colore info)
- `--success`: #00a8ff (Colore success)
- `--warning`: #F39C12 (Colore warning)
- `--error`: #E74C3C (Colore error)

### Font System
- `--font-primary`: 'Inter' (Font principale)
- `--font-display`: 'Bebas Neue' (Font display)
- `--font-accent`: 'Gloss And Bloom' (Font accent personalizzato)

### Personalizzazione
- **Override per pagina**: Tramite database (campo `css_variables`)
- **Override globali**: Modifica `variables.css`
- **Responsive**: Variabili per breakpoint
- **Font esterni**: Google Fonts + Font Awesome + Custom Fonts
- **Esempi**: `assets/css/examples/marathon-theme.css`
- **Documentazione**: `docs/COLORS_AND_FONTS.md`

## ğŸ§© MODULI DISPONIBILI
1. **actionHero** - Hero section con layout 2 colonne
2. **resultsTable** - Tabella risultati gara (ordinabile, filtri)
3. **menu** - Menu navigazione (sticky, mobile-friendly)
4. **footer** - Footer sito (4 colonne, social)
5. **richText** - Contenuti testuali ricchi
6. **gallery** - Galleria immagini (lightbox)

## ğŸ—„ï¸ DATABASE SCHEMA
### Tabelle Principali
- `pages` - Pagine del sito
- `modules_registry` - Moduli disponibili
- `page_modules` - Moduli assegnati alle pagine
- `race_results` - Risultati gara
- `races` - Gare
- `dynamic_content` - Contenuti dinamici

### Setup Database
1. **Setup automatico**: `admin/test-setup.php`
2. **Pannello admin**: `admin/admin.php`
3. **Debug**: `debug.php`
4. **Path corretto**: `http://localhost/sito_modulare/`

## ğŸš€ WORKFLOW SVILUPPO

### Aggiungere Nuovo Modulo
1. **Crea cartella**: `modules/mio-modulo/`
2. **File necessari**: `mio-modulo.php`, `mio-modulo.css`, `mio-modulo.js`
3. **Registra modulo**: Inserisci in `modules_registry`
4. **Template modulo**:
```php
<?php
$moduleData = $renderer->getModuleData('mioModulo', $config);
?>
<div class="mio-modulo">
    <!-- Contenuto modulo -->
</div>
```

### Personalizzazione Colori
```css
/* In assets/css/core/variables.css */
:root {
  --primary-color: #TUO_COLORE;
  --secondary-color: #ALTRO_COLORE;
}
```

### Override per Pagina (Database)
```json
{
  "--primary-color": "#D81E05",
  "--hero-bg": "linear-gradient(135deg, #667eea 0%, #764ba2 100%)"
}
```

## ğŸ”§ COMANDI UTILI

### Setup Iniziale
1. **Avvia XAMPP** (Apache + MySQL)
2. **Setup database**: `http://localhost/sito_modulare/admin/test-setup.php`
3. **Test pagina**: `http://localhost/sito_modulare/index.php`

### File di Test
- **Versione semplice**: `index-simple.php` (senza database)
- **Debug database**: `debug.php`
- **Test setup**: `test.php`

### Build System
```bash
npm install
npm run dev        # Watch mode senza server
npm run serve      # Watch mode con BrowserSync
npm run build      # Build solo asset
npm run release    # Build completo per cloud deployment
```

**âš ï¸ IMPORTANTE**: NON eseguire build automatici durante lo sviluppo. 
Il build Ã¨ necessario SOLO:
- Su richiesta esplicita dell'utente
- Prima del deploy su cloud
- Per testare versione produzione

## ğŸ¯ OBIETTIVI PROGETTO
- **Sistema modulare** riutilizzabile
- **CSS Variables** per personalizzazioni
- **SSR** per performance e SEO
- **Responsive** design
- **Facile estensione** con nuovi moduli
- **AI-friendly** per generazione automatica pagine

## ğŸ“ NOTE IMPORTANTI
- **Path corretto**: `http://localhost/sito_modulare/`
- **Database**: MySQL su XAMPP
- **Status pagina**: Deve essere "published" per essere visibile
- **Moduli**: Ogni modulo ha PHP + CSS + JS nella stessa cartella
- **CSS Variables**: Sistema di personalizzazione principale
- **Build**: SOLO su richiesta esplicita, mai automatico durante sviluppo
- **Sviluppo**: Modifica file direttamente, usa `npm run dev` per live-reload

## ğŸš¨ PROBLEMI COMUNI
1. **"Pagina non trovata"**: Controlla status = 'published'
2. **Database vuoto**: Usa `admin/test-setup.php`
3. **Moduli mancanti**: Verifica `modules_registry`
4. **Path sbagliato**: Usa `http://localhost/sito_modulare/`
5. **"Undefined variable $renderer"**: Variabile passata automaticamente dal ModuleRenderer
6. **Percorsi moduli**: Devono essere relativi (es. `hero/hero.php` non `modules/hero/hero.php`)
7. **SQL LIMIT error**: LIMIT non puÃ² essere parametro preparato, usa concatenazione sicura

## ğŸ§© SVILUPPO MODULI

### Guida Completa
- **Documentazione**: `MODULE-DEVELOPMENT-GUIDE.md` (guida completa)
- **Regole**: `MODULE-RULES.md` (regole specifiche)
- **Template**: `MODULE-TEMPLATE.md` (template completo)
- **Checklist**: `MODULE-CHECKLIST.md` (checklist validazione)
- **Esempi**: `modules/README.md` (esempi pratici)

### Struttura Modulo Obbligatoria
```
modules/mio-modulo/
â”œâ”€â”€ mio-modulo.php          # Template PHP (OBBLIGATORIO)
â”œâ”€â”€ mio-modulo.css          # Stili CSS (OBBLIGATORIO)
â”œâ”€â”€ module.json             # Manifest modulo (OBBLIGATORIO)
â”œâ”€â”€ mio-modulo.js           # JavaScript (OPZIONALE)
â”œâ”€â”€ install.sql             # Setup database (OPZIONALE)
â””â”€â”€ README.md               # Documentazione (OPZIONALE)
```

### Regole CSS CRITICHE
- **MAI stili annidati** (`&:hover`, `&::before`)
- **SOLO CSS classico** esplicito
- **CSS Variables** obbligatorie
- **BEM methodology** per classi
- **Mobile-first** responsive

### Template PHP Standard
```php
<?php
$moduleData = $renderer->getModuleData('mioModulo', $config);
$title = $config['title'] ?? $moduleData['title'] ?? 'Default';
?>
<div class="mio-modulo mio-modulo--<?= htmlspecialchars($variant) ?>">
    <!-- Contenuto -->
</div>
```

### Manifest module.json
```json
{
  "name": "mio-modulo",
  "slug": "mio-modulo",
  "component_path": "mio-modulo/mio-modulo.php",
  "default_config": {},
  "ui_schema": {}
}
```

### Page Builder Integration
- **CSS Override** per disabilitare `position: fixed`
- **UI Schema** completo per configurazione
- **Drag & Drop** support
- **Real-time preview** funzionante

## ğŸ”„ PROSSIMI PASSI
1. **Test sistema** con `index.php`
2. **Setup database** con `admin/test-setup.php`
3. **Personalizza colori** con Theme Editor
4. **Aggiungi moduli** secondo necessitÃ 
5. **Deploy** su server produzione

## ğŸ“š DOCUMENTAZIONE CONSOLIDATA

### Guide Principali
- **`MODULE-DEVELOPMENT-GUIDE.md`** - Guida completa sviluppo moduli
- **`LAYOUT-SYSTEM.md`** - Sistema layout responsive
- **`THEME-SYSTEM-FINAL.md`** - Sistema temi dinamici
- **`BUILD-SYSTEM.md`** - Sistema build e deploy
- **`DOCUMENTATION-INDEX.md`** - Indice completo documentazione

### Strumenti Admin
- **`admin/theme-editor.php`** - Gestione temi e colori
- **`admin/page-builder.php`** - Costruttore pagine modulare
- **`admin/test-setup.php`** - Setup database

## ğŸ¨ SISTEMA TEMI AGGIORNATO
- **Theme Editor**: Gestione completa temi dinamici
- **CSS Variables**: Sistema automatico di generazione
- **Override Sezioni**: Supporto per classi specifiche
- **Database**: Struttura compatibile con entrambe le versioni

## ğŸ§© REGOLE MODULI CONSOLIDATE
- **Struttura**: `modulo.php`, `modulo.css`, `module.json`
- **CSS**: SOLO CSS classico, MAI stili annidati
- **BEM**: Metodologia obbligatoria per classi
- **Responsive**: Mobile-first design
- **Database**: Prepared statements obbligatori
- **Sicurezza**: Sanitizzazione output obbligatoria
